<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marksheet Generator</title>
    <style>
        /* Resetting default styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Times New Roman', Times, serif;
            background-image: linear-gradient(90deg, cyan, grey);
        }
        .btn {
            display: inline-block;
            margin: 10px;
            padding: 10px 20px;
            border: 2px solid transparent;
            border-radius: 5px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            transition: background-color 0.3s ease;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .result-div {
            border: 1px solid grey;
            background-color: grey;
            margin-top: 20px;
            text-align: center;
        }
        .result-div h2 {
            color: white;
            padding: 10px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
        }
        .result-div h2:hover {
            background-color: wheat;
            color: black;
        }
    </style>
</head>
<body>
    <div class="container">
        <h3 class="header">Marksheet Generator</h3>
        <div class="course-div">
            <form class="get">
                <h2>
                    <label for="courses">Course Code:</label>
                    <label for="course-unit">Credit Hr:</label>
                    <label for="course-grade">Course Grade:</label>
                </h2>
                <input type="text" placeholder="Enter the course code" class="courses" required>
                <input type="number" placeholder="Enter the credit hr" class="course-unit" required>
                <select class="grade" id="grades" required>
                    <option value="select">Select</option>
                    <option value="A" class="grade">A</option>
                    <option value="B" class="grade">B</option>
                    <option value="C" class="grade">C</option>
                    <option value="D" class="grade">D</option>
                    <option value="E" class="grade">E</option>
                    <option value="F" class="grade">F</option>
                </select>
            </form>
        </div>
        <div class="buttons">
            <button class="btn btn-primary" id="add-course">Add course</button>
            <button class="btn btn-danger" id="remove-course">Remove course</button>
            <button class="btn btn-success" id="get-grade">Calculate CGPA</button>
            <button class="btn btn-secondary" id="generate-marksheet">Generate Marksheet</button>
        </div>
        <footer>
            <div class="result-div">
                <h2 id="result">CGPA: </h2>
            </div>
        </footer>
    </div>
    <script>
        function calculateGrade(grade, unit) {
            if (grade === 'A') {
                return 5 * unit;
            } else if (grade === 'B') {
                return 4 * unit;
            } else if (grade === 'C') {
                return 3 * unit;
            } else if (grade === 'D') {
                return 2 * unit;
            } else if (grade === 'E') {
                return 1 * unit;
            } else if (grade === 'F') {
                return 0 * unit;
            }
        }

        let count = 0;
        document.querySelector('#add-course').addEventListener('click', addNewCourse);
        
        function addNewCourse() {
            let newForm = document.createElement('form');
            newForm.classList.add('addNew', `get-${count}`);
            const courseName = `
                <input type="text" placeholder="Enter the course code" class="courses get-${count}" required>
                <input type="number" placeholder="Enter the course unit" class="course-unit get-${count}" required>
                <select class="grade get-${count}" id="grades" required>
                    <option value="select">Select</option>
                    <option value="A" class="grade">A</option>
                    <option value="B" class="grade">B</option>
                    <option value="C" class="grade">C</option>
                    <option value="D" class="grade">D</option>
                    <option value="E" class="grade">E</option>
                    <option value="F" class="grade">F</option>
                </select>
            `;
            newForm.innerHTML = courseName;
            document.querySelector('.course-div').appendChild(newForm);
            count++;
        }

        document.querySelector('#remove-course').addEventListener('click', removeForm);
        
        function removeForm() {
            let lastForm = document.querySelector('.course-div').lastElementChild;
            if (lastForm.tagName === 'FORM') {
                lastForm.remove();
            }
        }

        document.querySelector('#get-grade').addEventListener('click', gpacalculator);
        
        function gpacalculator() {
            const RESULTBAR = document.getElementById('result');
            const GRADESELECT = document.querySelectorAll('select.grade');
            const UNIT = document.querySelectorAll('input.course-unit');
            const listofUnits = [];
            const listofGrades = [];
            let totalUnits = 0;
            GRADESELECT.forEach((e) => {
                let GRADES = e.options;
                const selectedIndex = e.selectedIndex;
                const selectedGrade = GRADES[selectedIndex].text.toUpperCase();
                listofGrades.push(selectedGrade);
            });
            UNIT.forEach((e) => {
                const unitValue = parseInt(e.value);
                totalUnits += unitValue;
                listofUnits.push(unitValue);
            });
            let totalEarnedUnits = 0;
            for (let i = 0; i < listofUnits.length; i++) {
                totalEarnedUnits += calculateGrade(listofGrades[i], listofUnits[i]);
            }
            const gpa = totalEarnedUnits / totalUnits;
            if (!isNaN(gpa) && gpa >= 0) {
                RESULTBAR.textContent = 'CGPA: ' + gpa.toFixed(2);
            } else {
                RESULTBAR.textContent = 'Please enter a correct grade and course unit.';
            }
        }

        document.querySelector('#generate-marksheet').addEventListener('click', generateMarksheet);
        
        function generateMarksheet() {
            const COURSESELECT = document.querySelectorAll('input.courses');
            const GRADESELECT = document.querySelectorAll('select.grade');
            const UNIT = document.querySelectorAll('input.course-unit');
            let marksheet = 'Marksheet\n\nCourse Code\tCredit Hr\tGrade\n';
            COURSESELECT.forEach((course, index) => {
                marksheet += `${course.value}\t${UNIT[index].value}\t${GRADESELECT[index].value}\n`;
            });
            alert(marksheet);
        }
    </script>

</body>
</html>
